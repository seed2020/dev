<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- TABLE : PT_AUTH_GRP_USER_R[권한그룹사용자관계] -->
<mapper namespace="com.innobiz.orange.web.wb.dao.WbBcBDao">

	<resultMap id="wbBcBMap" type="WbBcBVo">
		<id property="bcId" column="BC_ID" /><!-- 명함ID -->
		<result property="publTypCd" column="OPEN_TYP_CD" /><!-- 공개구분코드 -->
		<result property="fldId" column="FLD_ID" /><!-- 폴더ID -->
		<result property="fldNm" column="FLD_NM" /><!-- 폴더명 -->
		<result property="bcNm" column="BC_NM" /><!-- 명함성명 -->
		<result property="rnum" column="RNUM" /><!-- 레코드 번호 -->
		<result property="bcEnNm" column="BC_EN_NM" /><!-- 명함영문성명 -->
		<result property="dftCntcTypCd" column="DFT_CNTC_TYP_CD" /><!-- 기본연락처구분코드 -->
		<result property="compNm" column="COMP_NM" /><!-- 회사명 -->
		<result property="deptNm" column="DEPT_NM" /><!-- 부서명 -->
		<result property="gradeNm" column="GRADE_NM" /><!-- 직급명 -->
		<result property="tichCont" column="TICH_CONT" /><!-- 담당업무내용 -->
		<result property="iptfgYn" column="IPTFG_YN" /><!-- 주요인사여부 -->
		<result property="fno" column="FNO" /><!-- 팩스번호 -->
		<!-- 주소 -->
		<result property="compZipNo" column="COMP_ZIP_NO" /><!-- 회사우편번호 -->
		<result property="compAdr" column="COMP_ADR" /><!-- 회사주소 -->
		<result property="homeZipNo" column="HOME_ZIP_NO" /><!-- 회사우편번호 -->
		<result property="homeAdr" column="HOME_ADR" /><!-- 회사주소 -->
		<result property="bumkYn" column="BUMK_YN" /><!-- 즐겨찾기여부 -->
		<result property="genCd" column="GEN_CD" /><!-- 성별코드 -->
		<result property="genNm" column="GEN_NM" /><!-- 성별이름 -->
		<result property="natyCd" column="NATY_CD" /><!-- 국적코드 -->
		<result property="natyNm" column="NATY_NM" /><!-- 국적명 -->
		<result property="birth" column="BIRTH" /><!-- 생년월일 -->
		<result property="birthSclcCd" column="BIRTH_SCLC_CD" /><!-- 생년월일월력코드 -->
		<result property="weddAnnv" column="WEDD_ANNV" /><!-- 결혼기념일 -->
		<result property="weddAnnvSclcCd" column="WEDD_ANNV_SCLC_CD" /><!-- 결혼기념일월력코드 -->
		<result property="psnHpageUrl" column="PSN_HPAGE_URL" /><!-- 개인홈페이지URL -->
		<result property="compHpageUrl" column="COMP_HPAGE_URL" /><!-- 회사홈페이지URL -->
		<result property="hobyCont" column="HOBY_CONT" /><!-- 취미내용 -->
		<result property="spectCont" column="SPECT_CONT" /><!-- 특기사항내용 -->
		<result property="eschlNm" column="ESCHL_NM" /><!-- 초등학교명 -->
		<result property="mschlNm" column="MSCHL_NM" /><!-- 중학교명 -->
		<result property="hschlNm" column="HSCHL_NM" /><!-- 고등학교명 -->
		<result property="univCont" column="UNIV_CONT" /><!-- 대학교내용 -->
		<result property="bhistCont" column="BHIST_CONT" /><!-- 약력내용 -->
		<result property="clnsId" column="CLNS_ID" /><!-- 친밀도ID -->
		<result property="clnsNm" column="CLNS_NM" /><!-- 친밀도명 -->
		<result property="noteCont" column="NOTE_CONT" /><!-- 비고내용 -->
		<result property="bcRegTypCd" column="BC_REG_TYP_CD" /><!-- 명함등록구분코드 -->
		<result property="regrUid" column="REGR_UID" /><!-- 등록자UID -->
		<result property="regDt" column="REG_DT" /><!-- 등록일 -->
		<result property="compPhon" column="COMP_PHON" /><!-- 회사전화 -->
		<result property="homePhon" column="HOME_PHON" /><!-- 자택전화 -->
		<result property="mbno" column="MBNO" /><!-- 이동전화 -->
		<result property="email" column="EMAIL" /><!-- 이메일 -->
		<result property="regrNm" column="REGR_NM" /><!-- 등록자명 -->
		<result property="compId" column="COMP_ID" /><!-- 회사ID -->
		<result property="originalBcId" column="ORIGINAL_BC_ID" /><!-- 원본명함ID -->
		<result property="mainSetupYn" column="MAIN_SETUP_YN" /><!-- 메인설정여부 -->
		<result property="duplicateBcId" column="DUPLICATE_BC_ID" /><!-- 사본명함ID -->
		<result property="dftCntc" column="DFT_CNTC" /><!-- 기본연락처 -->
		<result property="initialNm" column="INITIAL_NM" /><!-- 초성명 -->
		
	</resultMap>
	
	<!-- 조회조건 -->
	<sql id="selectWbBcBWhere">
		<where>
			<if test="bcId != null and bcId !=''"> AND T.BC_ID = #{bcId, jdbcType=VARCHAR}</if>
			<if test="originalBcId != null and originalBcId !=''"> AND T.ORIGINAL_BC_ID = #{originalBcId, jdbcType=VARCHAR}</if>
			<if test="publTypCd != null and publTypCd !=''"> AND T.OPEN_TYP_CD = #{publTypCd, jdbcType=VARCHAR}</if>
			<if test="mainSetupYn != null and mainSetupYn !=''"> AND T.MAIN_SETUP_YN = #{mainSetupYn, jdbcType=VARCHAR}</if>
			<if test="duplicateBcId != null and duplicateBcId !=''"> AND T.DUPLICATE_BC_ID = #{duplicateBcId, jdbcType=VARCHAR}</if>
			<if test="regrUid != null and regrUid !=''"> AND T.REGR_UID = #{regrUid, jdbcType=VARCHAR}</if>
			<if test="compId != null and compId !=''"> AND T.COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test="'pwsmName'.equals(schCat) and schWord != null and schWord != ''">AND T.BC_NM = #{schWord, jdbcType=VARCHAR}</if>
			<!-- 사용자 목록설정에 따른 컬럼 조회  -->
			<if test="'bcNm'.equals(schCat) and schWord != null and schWord != ''">AND T.BC_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test="'birth'.equals(schCat) and schWord != null and schWord != ''"><![CDATA[ AND REPLACE(CONVERT(VARCHAR(10), T.BIRTH, 120),'-','') = REPLACE(#{schWord, jdbcType=VARCHAR},'-','')]]></if>
			<if test="'compNm'.equals(schCat) and schWord != null and schWord != ''">AND T.COMP_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test="'deptNm'.equals(schCat) and schWord != null and schWord != ''">AND T.DEPT_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test="'fno'.equals(schCat) and schWord != null and schWord != ''">AND T.FNO LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test="'genNm'.equals(schCat) and schWord != null and schWord != ''">AND T.GEN_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test="'gradeNm'.equals(schCat) and schWord != null and schWord != ''">AND T.GRADE_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test="'weddAnnv'.equals(schCat) and schWord != null and schWord != ''"><![CDATA[ AND REPLACE(CONVERT(VARCHAR(10), T.WEDD_ANNV, 120),'-','') = REPLACE(#{schWord, jdbcType=VARCHAR},'-','')]]></if>
			<if test="'clnsNm'.equals(schCat) and schWord != null and schWord != ''">AND T.CLNS_ID = ( SELECT CLNS_ID FROM WB_BC_CLNS_C WBL_T WHERE WBL_T.REGR_UID = T.REGR_UID AND WBL_T.CLNS_ID = T.CLNS_ID AND WBL_T.CLNS_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%' )</if>
			<if test="('compPhon'.equals(schCat) or 'homePhon'.equals(schCat) or 'mbno'.equals(schCat) or 'email'.equals(schCat)) and schWord != null and schWord != ''">
				AND T.BC_ID IN( SELECT WBC_T.BC_ID FROM WB_BC_CNTC_D WBC_T WHERE WBC_T.BC_ID = T.BC_ID	AND WBC_T.CNTC_TYP_CD = #{schCat, jdbcType=VARCHAR} AND REPLACE(WBC_T.CNTC_CONT,'-','') LIKE '%'+REPLACE(#{schWord, jdbcType=VARCHAR},'-','')+'%'  GROUP BY WBC_T.BC_ID	)
			</if>
			<!-- 관리자일경우 -->
			<if test="'regrNm'.equals(schCat) and schWord != null and schWord != ''">AND OU_T.USER_NM LIKE '%'+#{schWord, jdbcType=VARCHAR}+'%'</if>
			<if test='schIptfgYn != null and schIptfgYn != "" and "Y".equals(schIptfgYn)'> AND T.IPTFG_YN = #{schIptfgYn, jdbcType=VARCHAR}</if>
			<!-- 초성검색 -->
			<if test="schInitial != null and schInitial != ''">
				<if test="'A~Z'.equals(schInitial)">AND LOWER(INITIAL_NM) IN('a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z')</if>
				<if test="!'A~Z'.equals(schInitial)">AND INITIAL_NM = #{schInitial, jdbcType=VARCHAR}</if>
			</if>
			<!-- 폴더조회  -->
			<if test='schFldTypYn != "" and "F".equals(schFldTypYn) and schFldId != null and schFldId != ""'>AND T.FLD_ID = #{schFldId, jdbcType=VARCHAR}</if>
			<if test='schFldTypYn != "" and "A".equals(schFldTypYn) and wbBcFldBVo != null'>
				AND T.FLD_ID IN( <foreach collection="wbBcFldBVo" item="item" index="index" separator=",">#{item.bcFldId, jdbcType=VARCHAR}</foreach> )
			</if>
			<!-- 다중 조회조건(String) -->
			<if test="whereSqllet != null and whereSqllet != ''"> ${whereSqllet}</if>
			<!-- 기간검색 -->
			<if test="'fromYmd'.equals(durCat) and durStrtDt != null and durStrtDt != ''"><![CDATA[ AND CONVERT(VARCHAR(10), T.REG_DT, 120)  >= #{durStrtDt, jdbcType=VARCHAR}]]></if>
			<if test="'fromYmd'.equals(durCat) and durEndDt != null and durEndDt != ''"><![CDATA[ AND CONVERT(VARCHAR(10), T.REG_DT, 120) <= #{durEndDt, jdbcType=VARCHAR}]]></if>
			<if test="schRegrUid != null and schRegrUid !=''"> AND T.REGR_UID = #{schRegrUid, jdbcType=VARCHAR}</if>
			<!-- 즐겨찾기 조회 -->
			<!-- <if test="schBumkYn != null and schBumkYn != ''">AND T.BUMK_YN = #{schBumkYn, jdbcType=VARCHAR}</if> -->
		</where>
	</sql>
	
	<!-- 공개명함 조인절 -->
	<sql id="selectWbBcBJoin">
		<if test="schOpenTypCds != null and schOpenTypCds !=''">
			INNER JOIN (
				SELECT BC_ID , 'allPubl' AS SCH_OPEN_TYP_CD
				FROM <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if>
				WHERE OPEN_TYP_CD = 'allPubl'
				AND MAIN_SETUP_YN IN ('O','C','Y')
				<if test="schCompId != null and schCompId !='' and schDeptId != null and schDeptId !=''">
					UNION
					SELECT BC_ID , 'deptPubl' AS SCH_OPEN_TYP_CD
					FROM <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if>
					WHERE OPEN_TYP_CD = 'deptPubl'
					AND REGR_UID IN(
						SELECT USER_UID 
						FROM OR_USER_B OU_T
						WHERE COMP_ID = #{schCompId, jdbcType=VARCHAR} AND DEPT_ID = #{schDeptId, jdbcType=VARCHAR}
					)
				</if>
				<if test="schUserUid != null and schUserUid !=''">
					UNION 
					SELECT BC_ID , 'apntrPubl' AS SCH_OPEN_TYP_CD
					FROM WB_BC_APNTR_R
					WHERE BC_APNTR_UID = #{schUserUid, jdbcType=VARCHAR}
				</if>
			) TMP_T ON T.BC_ID = TMP_T.BC_ID 
			AND TMP_T. SCH_OPEN_TYP_CD IN ( <foreach collection="schOpenTypCds" item="item" index="index" separator=",">#{item, jdbcType=VARCHAR}</foreach> )
		</if>
	</sql>
	<!-- 목록조회 -->
	<select id="selectWbBcB" resultMap="wbBcBMap" parameterType="WbBcBVo" >
		/* com.innobiz.orange.web.wb.dao.WbBcBDao.selectWbBcB */
		<if test="pageNo != null and pageRowCnt != null">
		SELECT * FROM (
		</if>
		SELECT
		<trim prefix="" suffix="" suffixOverrides=",">
			<if test="pageNo != null and pageRowCnt != null">
			TOP (#{pageNo, jdbcType=NUMERIC} * #{pageRowCnt, jdbcType=NUMERIC}) ROW_NUMBER() OVER (ORDER BY <if test="orderBy != null">${orderBy}</if><if test="orderBy == null">N.BC_NM ASC , N.REG_DT DESC</if>) AS RNUM, N.* 
			FROM (
				SELECT
			</if>
			T.BC_ID,
			T.OPEN_TYP_CD,
			T.FLD_ID,
			<if test="isPub">
			(SELECT RESC_VA FROM WM_RESC_B WHERE COMP_ID = T.COMP_ID AND RESC_ID = (SELECT RESC_ID FROM WB_PUB_FLD_B WHERE FLD_ID = T.FLD_ID) AND LANG_TYP_CD = ISNULL(#{queryLang, jdbcType=VARCHAR},'ko')) AS FLD_NM,
			</if>
			<if test="!isPub">
			(SELECT WBFB_T.FLD_NM FROM WB_BC_FLD_B WBFB_T WHERE WBFB_T.BC_FLD_ID = T.FLD_ID ) AS FLD_NM,
			</if>
			T.BC_NM,
			T.BC_EN_NM,
			T.DFT_CNTC_TYP_CD,
			T.COMP_NM,
			T.DEPT_NM,
			T.GRADE_NM,
			T.TICH_CONT,
			T.IPTFG_YN,
			T.FNO,
			T.COMP_ZIP_NO,
			T.COMP_ADR,
			T.COMP_DETL_ADR,
			T.HOME_ZIP_NO,
			T.HOME_ADR,
			T.HOME_DETL_ADR,
		   T.BUMK_YN,
		   T.PHOTO_FILE_ID,
		   T.GEN_CD,
		   (SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = (SELECT RESC_ID FROM PT_CD_B WHERE CLS_CD = 'GEN_CD' AND CD = T.GEN_CD) AND LANG_TYP_CD = ISNULL(#{queryLang, jdbcType=VARCHAR},'ko') ) AS GEN_NM ,
		   T.NATY_CD , 
		   (SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = (SELECT RESC_ID FROM PT_CD_B WHERE CLS_CD = 'NATY_CD' AND CD = T.NATY_CD) AND LANG_TYP_CD = ISNULL(#{queryLang, jdbcType=VARCHAR},'ko') ) AS NATY_NM ,
		   CONVERT(VARCHAR(10), T.BIRTH, 120) BIRTH  ,T.BIRTH_SCLC_CD ,CONVERT(VARCHAR(10), T.WEDD_ANNV, 120) WEDD_ANNV ,T.WEDD_ANNV_SCLC_CD ,T.PSN_HPAGE_URL ,
		   T.COMP_HPAGE_URL ,T.HOBY_CONT ,T.SPECT_CONT ,T.ESCHL_NM ,T.MSCHL_NM ,T.HSCHL_NM ,T.UNIV_CONT ,T.BHIST_CONT ,T.CLNS_ID ,
		   ( SELECT CLNS_NM FROM WB_BC_CLNS_C WBL_T WHERE WBL_T.REGR_UID = T.REGR_UID AND WBL_T.CLNS_ID = T.CLNS_ID) AS CLNS_NM ,
		   T.NOTE_CONT ,T.ATT_FILE_ID ,T.BC_REG_TYP_CD ,T.REGR_UID ,CONVERT(VARCHAR(10), T.REG_DT, 120) AS REG_DT ,T.MODR_UID ,T.MOD_DT , 
		   ( SELECT CNTC_CONT FROM WB_BC_CNTC_D WBC_T WHERE WBC_T.BC_ID = T.BC_ID AND WBC_T.CNTC_CLS_CD = 'CNTC' AND CNTC_TYP_CD = 'compPhon' AND WBC_T.BC_CNTC_SEQ = 1 ) AS COMP_PHON ,
		   ( SELECT CNTC_CONT FROM WB_BC_CNTC_D WBC_T WHERE WBC_T.BC_ID = T.BC_ID AND WBC_T.CNTC_CLS_CD = 'CNTC' AND CNTC_TYP_CD = 'homePhon' AND WBC_T.BC_CNTC_SEQ = 1 ) AS HOME_PHON , 
		   ( SELECT CNTC_CONT FROM WB_BC_CNTC_D WBC_T WHERE WBC_T.BC_ID = T.BC_ID AND WBC_T.CNTC_CLS_CD = 'CNTC' AND CNTC_TYP_CD = 'mbno' AND WBC_T.BC_CNTC_SEQ = 1 ) AS MBNO ,
		   ( SELECT CNTC_CONT FROM WB_BC_CNTC_D WBC_T WHERE WBC_T.BC_ID = T.BC_ID AND WBC_T.CNTC_CLS_CD = 'EMAIL' AND CNTC_TYP_CD = 'email' AND WBC_T.BC_CNTC_SEQ = 1 ) AS EMAIL ,
		   (SELECT RESC_VA FROM OR_RESC_B WHERE RESC_ID = OU_T.RESC_ID  AND LANG_TYP_CD = ISNULL(#{queryLang, jdbcType=VARCHAR},'ko') ) AS REGR_NM,
		   T.COMP_ID , T.ORIGINAL_BC_ID , T.MAIN_SETUP_YN , T.DUPLICATE_BC_ID , 
		   ( SELECT CNTC_CONT FROM WB_BC_CNTC_D WBC_T WHERE WBC_T.BC_ID = T.BC_ID AND WBC_T.CNTC_CLS_CD = 'CNTC' AND CNTC_TYP_CD = T.DFT_CNTC_TYP_CD AND WBC_T.BC_CNTC_SEQ = 1 ) AS DFT_CNTC ,
		   INITIAL_NM
		</trim>
		FROM <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if> T LEFT OUTER JOIN OR_USER_B OU_T ON T.REGR_UID = OU_T.USER_UID									   
		<include refid="selectWbBcBJoin"/>
		<include refid="selectWbBcBWhere"/>
		<if test="pageNo == null or pageRowCnt == null">
			<if test="orderBy != null">ORDER BY ${orderBy}</if>
			<if test="orderBy == null">ORDER BY T.BC_NM ASC , CONVERT(VARCHAR(10), T.REG_DT, 120) DESC </if>
		</if>
		<if test="pageNo != null and pageRowCnt != null">
		<![CDATA[) N ) M WHERE RNUM > (#{pageNo, jdbcType=NUMERIC} - 1) * #{pageRowCnt, jdbcType=NUMERIC} AND RNUM <= #{pageNo, jdbcType=NUMERIC} * #{pageRowCnt, jdbcType=NUMERIC}]]>
		</if>
	</select>
	
	<!-- 목록조회 건수-->
	<select id="countWbBcB" resultType="Integer" parameterType="WbBcBVo" >
		/* com.innobiz.orange.web.wb.dao.WbBcBDao.countWbBcB */
		SELECT COUNT(*) CNT
		FROM <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if> T LEFT OUTER JOIN OR_USER_B OU_T ON T.REGR_UID = OU_T.USER_UID
		<include refid="selectWbBcBJoin"/>
		<include refid="selectWbBcBWhere"/>
	</select>
	
	<!-- 명함 등록 저장 -->
	<insert id="insertWbBcB" parameterType="WbBcBVo" >
		/* com.innobiz.orange.web.wb.dao.WbBcBDao.insertWbBcB */
		INSERT INTO <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if>
		<trim prefix="(" suffix=")" suffixOverrides=",">
			BC_ID,
			OPEN_TYP_CD,
			FLD_ID,
			BC_NM,
			BC_EN_NM,DFT_CNTC_TYP_CD,COMP_NM,
			DEPT_NM,
			GRADE_NM,
			TICH_CONT,
			IPTFG_YN,
			FNO,
			COMP_ZIP_NO,
			COMP_ADR,
			COMP_DETL_ADR,
			HOME_ZIP_NO,
			HOME_ADR,
			HOME_DETL_ADR,
			BUMK_YN,
			PHOTO_FILE_ID,
			GEN_CD,
			NATY_CD,
			BIRTH,
			BIRTH_SCLC_CD,
			WEDD_ANNV,
			WEDD_ANNV_SCLC_CD,PSN_HPAGE_URL,
			COMP_HPAGE_URL,
			HOBY_CONT,
			SPECT_CONT,
			ESCHL_NM,
			MSCHL_NM,
			HSCHL_NM,
			UNIV_CONT,
			BHIST_CONT,CLNS_ID,
			NOTE_CONT,
			ATT_FILE_ID,
			BC_REG_TYP_CD,
			REGR_UID,
			DEL_YN,
			EMAIL,
			COMP_ID,
			ORIGINAL_BC_ID,
			MAIN_SETUP_YN,
			INITIAL_NM, 
			REG_DT,
		</trim>
		<trim prefix="VALUES (" suffix=")" suffixOverrides="," >
			#{bcId, jdbcType=VARCHAR},
			#{publTypCd, jdbcType=VARCHAR},
			#{fldId, jdbcType=VARCHAR},
			#{bcNm, jdbcType=VARCHAR},
			#{bcEnNm, jdbcType=VARCHAR},
			#{dftCntcTypCd, jdbcType=VARCHAR},
			#{compNm, jdbcType=VARCHAR},
			#{deptNm, jdbcType=NVARCHAR},
			#{gradeNm, jdbcType=VARCHAR},
			#{tichCont, jdbcType=VARCHAR},
			#{iptfgYn, jdbcType=VARCHAR},
			#{fno, jdbcType=VARCHAR},
			#{compZipNo, jdbcType=VARCHAR},
			#{compAdr, jdbcType=VARCHAR},
			#{compDetlAdr, jdbcType=VARCHAR},
			#{homeZipNo, jdbcType=VARCHAR},
			#{homeAdr, jdbcType=VARCHAR},
			#{homeDetlAdr, jdbcType=VARCHAR},
			#{bumkYn, jdbcType=VARCHAR},
			#{photoFileId, jdbcType=VARCHAR},
			#{genCd, jdbcType=VARCHAR},
			#{natyCd, jdbcType=VARCHAR},
			<if test="birth != null and birth != '' ">CONVERT(DATETIME, #{birth, jdbcType=VARCHAR}, 120),</if>	<if test="birth == null or birth == '' ">NULL,</if>
			#{birthSclcCd, jdbcType=VARCHAR},
			<if test="weddAnnv != null and weddAnnv != '' ">CONVERT(DATETIME, #{weddAnnv, jdbcType=VARCHAR}, 120),</if>	<if test="weddAnnv == null or weddAnnv == '' ">NULL,</if>			
			#{weddAnnvSclcCd, jdbcType=VARCHAR},
			#{psnHpageUrl, jdbcType=VARCHAR},
			#{compHpageUrl, jdbcType=VARCHAR},
			#{hobyCont, jdbcType=VARCHAR},
			#{spectCont, jdbcType=VARCHAR},
			#{eschlNm, jdbcType=VARCHAR},
			#{mschlNm, jdbcType=VARCHAR},
			#{hschlNm, jdbcType=VARCHAR},
			#{univCont, jdbcType=VARCHAR},
			#{bhistCont, jdbcType=VARCHAR},
			#{clnsId, jdbcType=VARCHAR},
			#{noteCont, jdbcType=VARCHAR},
			#{attFileId, jdbcType=VARCHAR},
			#{bcRegTypCd, jdbcType=VARCHAR},
			#{regrUid, jdbcType=VARCHAR},
			#{delYn, jdbcType=VARCHAR},
			#{email, jdbcType=VARCHAR},
			#{compId, jdbcType=VARCHAR},
			#{originalBcId, jdbcType=VARCHAR},
			#{mainSetupYn, jdbcType=VARCHAR},
			#{initialNm, jdbcType=VARCHAR},
			<if test="regDt == 'sysdate'">GETDATE(),</if><if test="regDt == null or regDt == ''"><if test="modDt == 'sysdate'">GETDATE(),</if><if test="modDt != 'sysdate'">NULL,</if></if>
		</trim>
	</insert>
	
	<!-- 명함 수정 -->
	<update id="updateWbBcB" parameterType="WbBcBVo" >
		/* com.innobiz.orange.web.wb.dao.WbBcBDao.updateWbBcB */
		UPDATE <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if>
		<set>
			<if test="publTypCd != null"> OPEN_TYP_CD = #{publTypCd, jdbcType=VARCHAR},</if>
			<if test="fldId != null"> FLD_ID = #{fldId, jdbcType=NVARCHAR},</if>
			<if test="bcNm != null"> BC_NM = #{bcNm, jdbcType=VARCHAR},</if>
			<if test="bcEnNm != null"> BC_EN_NM = #{bcEnNm, jdbcType=VARCHAR},</if>
			<if test="dftCntcTypCd != null"> DFT_CNTC_TYP_CD = #{dftCntcTypCd, jdbcType=VARCHAR},</if>
			<if test="compNm != null"> COMP_NM = #{compNm, jdbcType=VARCHAR},</if>
			<if test="deptNm != null"> DEPT_NM = #{deptNm, jdbcType=VARCHAR},</if>
			<if test="gradeNm != null"> GRADE_NM = #{gradeNm, jdbcType=INTEGER},</if>
			<if test="tichCont != null"> TICH_CONT = #{tichCont, jdbcType=NVARCHAR},</if>
			<if test="iptfgYn != null"> IPTFG_YN = #{iptfgYn, jdbcType=VARCHAR},</if>
			<if test="fno != null"> FNO = #{fno, jdbcType=VARCHAR},</if>
			<if test="compZipNo != null"> COMP_ZIP_NO = #{compZipNo, jdbcType=VARCHAR},</if>
			<if test="compAdr != null"> COMP_ADR = #{compAdr, jdbcType=VARCHAR},</if>
			<if test="compDetlAdr != null"> COMP_DETL_ADR = #{compDetlAdr, jdbcType=VARCHAR},</if>			
			<if test="homeZipNo != null"> HOME_ZIP_NO = #{homeZipNo, jdbcType=VARCHAR},</if>
			<if test="homeAdr != null"> HOME_ADR = #{homeAdr, jdbcType=VARCHAR},</if>
			<if test="homeDetlAdr != null"> HOME_DETL_ADR = #{homeDetlAdr, jdbcType=VARCHAR},</if>
			<if test="bumkYn != null"> BUMK_YN = #{bumkYn, jdbcType=VARCHAR},</if>
			<if test="photoFileId != null"> PHOTO_FILE_ID = #{photoFileId, jdbcType=VARCHAR},</if>
			<if test="genCd != null"> GEN_CD = #{genCd, jdbcType=VARCHAR},</if>
			<if test="natyCd != null"> NATY_CD = #{natyCd, jdbcType=VARCHAR},</if>
			<if test="birth != null">
				<if test="birth != '' ">BIRTH = CONVERT(DATETIME, #{birth, jdbcType=VARCHAR}, 120),</if>
				<if test="birth == '' "> BIRTH = NULL,</if>
			 </if>
			<if test="birthSclcCd != null"> BIRTH_SCLC_CD = #{birthSclcCd, jdbcType=VARCHAR},</if>
			<if test="weddAnnv != null">
				<if test="weddAnnv != '' ">WEDD_ANNV = CONVERT(DATETIME, #{weddAnnv, jdbcType=VARCHAR}, 120),</if>
				<if test="weddAnnv == '' "> WEDD_ANNV = NULL,</if>
			</if>
			<if test="weddAnnvSclcCd != null"> WEDD_ANNV_SCLC_CD = #{weddAnnvSclcCd, jdbcType=VARCHAR},</if>
			<if test="psnHpageUrl != null"> PSN_HPAGE_URL = #{psnHpageUrl, jdbcType=VARCHAR},</if>
			<if test="compHpageUrl != null"> COMP_HPAGE_URL = #{compHpageUrl, jdbcType=VARCHAR},</if>
			<if test="hobyCont != null"> HOBY_CONT = #{hobyCont, jdbcType=VARCHAR},</if>
			<if test="spectCont != null"> SPECT_CONT = #{spectCont, jdbcType=VARCHAR},</if>
			<if test="eschlNm != null"> ESCHL_NM = #{eschlNm, jdbcType=VARCHAR},</if>
			<if test="mschlNm != null"> MSCHL_NM = #{mschlNm, jdbcType=VARCHAR},</if>
			<if test="hschlNm != null"> HSCHL_NM = #{hschlNm, jdbcType=VARCHAR},</if>
			<if test="univCont != null"> UNIV_CONT = #{univCont, jdbcType=VARCHAR},</if>
			<if test="bhistCont != null"> BHIST_CONT = #{bhistCont, jdbcType=VARCHAR},</if>
			<if test="clnsId != null"> CLNS_ID = #{clnsId, jdbcType=VARCHAR},</if>
			<if test="noteCont != null"> NOTE_CONT = #{noteCont, jdbcType=VARCHAR},</if>
			<if test="attFileId != null"> ATT_FILE_ID = #{attFileId, jdbcType=VARCHAR},</if>
			<if test="bcRegTypCd != null"> BC_REG_TYP_CD = #{bcRegTypCd, jdbcType=VARCHAR},</if>
			<if test="delYn != null"> DEL_YN = #{delYn, jdbcType=VARCHAR},</if>
			<if test="email != null"> EMAIL = #{email, jdbcType=VARCHAR},</if>
			<if test="originalBcId != null"> ORIGINAL_BC_ID = #{originalBcId, jdbcType=VARCHAR},</if>
			<if test="mainSetupYn != null"> MAIN_SETUP_YN = #{mainSetupYn, jdbcType=VARCHAR},</if>
			<if test="resetYn != null and mainSetupYn == null"> MAIN_SETUP_YN = BC_REG_TYP_CD,</if>
			<if test="duplicateBcId != null"> DUPLICATE_BC_ID = #{duplicateBcId, jdbcType=VARCHAR},</if>
			<if test="initialNm != null"> INITIAL_NM = #{initialNm, jdbcType=VARCHAR},</if>
			<if test="modrUid != null"> MODR_UID = #{modrUid, jdbcType=VARCHAR},</if>
			<if test="modDt != null"> 
				<if test="modDt == 'sysdate'"> MOD_DT = GETDATE(),</if>
				<if test="modDt == ''"> MOD_DT = NULL,</if>
				<if test="modDt != '' and modDt != 'sysdate'"> MOD_DT = CONVERT(DATETIME, #{modDt, jdbcType=VARCHAR}, 120),</if>
			</if>
		</set>
		<where>
			<if test="bcId != null"> AND BC_ID = #{bcId, jdbcType=VARCHAR}</if>
			<if test="modrUid != null"> AND REGR_UID = #{modrUid, jdbcType=VARCHAR}</if>
			<if test="compId != null"> AND COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test="schOriginalBcId != null"> AND ORIGINAL_BC_ID = #{schOriginalBcId, jdbcType=VARCHAR}</if>
		</where>
	</update>

	<!-- 명함 삭제 -->
	<delete id="deleteWbBcB" parameterType="WbBcBVo" >
		/* com.innobiz.orange.web.wb.dao.WbBcBDao.deleteWbBcB */
		DELETE FROM <if test="!isPub">WB_BC_B</if><if test="isPub">WB_PUB_BC_B</if>
		<where>
			<if test="modrUid != null"> AND REGR_UID = #{modrUid, jdbcType=VARCHAR}</if>
			<if test="bcId != null"> AND BC_ID = #{bcId, jdbcType=VARCHAR}</if>
			<if test="compId != null"> AND COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test='schFldTypYn != "" and "A".equals(schFldTypYn) and wbBcFldBVo != null'>
				AND FLD_ID IN( <foreach collection="wbBcFldBVo" item="item" index="index" separator=",">#{item.bcFldId, jdbcType=VARCHAR}</foreach> )
			</if>
		</where>
	</delete>

</mapper>