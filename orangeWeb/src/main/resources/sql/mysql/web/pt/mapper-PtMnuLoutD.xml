<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<!-- TABLE : PT_MNU_LOUT_D[메뉴레이아웃상세] -->
<mapper namespace="com.innobiz.orange.web.pt.dao.PtMnuLoutDDao">

	<resultMap id="ptMnuLoutDMap" type="PtMnuLoutDVo">
		<id property="compId" column="COMP_ID" /><!-- 회사ID -->
		<id property="mnuLoutId" column="MNU_LOUT_ID" /><!-- 메뉴레이아웃ID -->
		<result property="loutCatId" column="LOUT_CAT_ID" /><!-- 레이아웃유형ID -->
		<result property="mnuLoutPid" column="MNU_LOUT_PID" /><!-- 메뉴레이아웃부모ID -->
		<result property="loutLocCd" column="LOUT_LOC_CD" /><!-- 레이아웃위치코드 -->
		<result property="mnuLoutKndCd" column="MNU_LOUT_KND_CD" /><!-- 레이아웃종류코드 -->
		<result property="mnuGrpId" column="MNU_GRP_ID" /><!-- 메뉴그룹ID -->
		<result property="mnuGrpRescId" column="MNU_GRP_RESC_ID" /><!-- 메뉴그룹리소스ID -->
		<result property="imgKndVa" column="IMG_KND_VA" /><!-- 이미지종류값 -->
		<result property="mnuLoutNm" column="MNU_LOUT_NM" /><!-- 메뉴레이아웃명 -->
		<result property="rescId" column="RESC_ID" /><!-- 리소스ID -->
		<result property="sortOrdr" column="SORT_ORDR" /><!-- 정렬순서 -->
		<result property="loutLocNm" column="LOUT_LOC_NM" /><!-- 레이아웃위치명 -->
		<result property="mnuLoutKndNm" column="MNU_LOUT_KND_NM" /><!-- 레이아웃종류명 -->
		<result property="mnuGrpRescNm" column="MNU_GRP_RESC_NM" /><!-- 메뉴그룹리소스명 -->
		<result property="rescNm" column="RESC_NM" /><!-- 리소스명 -->
		<result property="rnum" column="RNUM" /><!-- 레코드 번호 -->
	</resultMap>

	<select id="selectPtMnuLoutD" resultMap="ptMnuLoutDMap" parameterType="PtMnuLoutDVo" >
		/* com.innobiz.orange.web.pt.dao.PtMnuLoutDDao.selectPtMnuLoutD */
		<if test="pageNo != null and pageRowCnt != null">
		SELECT
		<trim prefix="" suffix="" suffixOverrides=",">
			M.*,
			(SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = (SELECT RESC_ID FROM PT_CD_B WHERE CLS_CD = 'LOUT_LOC_CD' AND CD = M.LOUT_LOC_CD) AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) LOUT_LOC_NM,
			(SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = (SELECT RESC_ID FROM PT_CD_B WHERE CLS_CD = 'MNU_LOUT_KND_CD' AND CD = M.MNU_LOUT_KND_CD) AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) MNU_LOUT_KND_NM,
			(SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = M.MNU_GRP_RESC_ID AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) MNU_GRP_RESC_NM,
			(SELECT RESC_VA FROM PT_RESC_D WHERE COMP_ID = M.COMP_ID AND RESC_ID = M.RESC_ID AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) RESC_NM,
		</trim>
		FROM (
		</if>
		SELECT
		<trim prefix="" suffix="" suffixOverrides=",">
			T.COMP_ID,
			T.MNU_LOUT_ID,
			T.LOUT_CAT_ID,
			T.MNU_LOUT_PID,
			T.LOUT_LOC_CD,
			T.MNU_LOUT_KND_CD,
			T.MNU_GRP_ID,
			T.MNU_GRP_RESC_ID,
			T.IMG_KND_VA,
			T.MNU_LOUT_NM,
			T.RESC_ID,
			T.SORT_ORDR,
			<if test="pageNo == null or pageRowCnt == null">
			(SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = (SELECT RESC_ID FROM PT_CD_B WHERE CLS_CD = 'LOUT_LOC_CD' AND CD = T.LOUT_LOC_CD) AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) LOUT_LOC_NM,
			(SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = (SELECT RESC_ID FROM PT_CD_B WHERE CLS_CD = 'MNU_LOUT_KND_CD' AND CD = T.MNU_LOUT_KND_CD) AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) MNU_LOUT_KND_NM,
			(SELECT RESC_VA FROM PT_RESC_B WHERE RESC_ID = T.MNU_GRP_RESC_ID AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) MNU_GRP_RESC_NM,
			(SELECT RESC_VA FROM PT_RESC_D WHERE COMP_ID = T.COMP_ID AND RESC_ID = T.RESC_ID AND LANG_TYP_CD = IFNULL(#{queryLang, jdbcType=VARCHAR},'ko')) RESC_NM,
			</if>
		</trim>
		FROM PT_MNU_LOUT_D T
		<where>
			<if test="compId != null">AND T.COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test="mnuLoutId != null">AND T.MNU_LOUT_ID = #{mnuLoutId, jdbcType=VARCHAR}</if>
			<if test="loutCatId != null and loutCatId != ''">AND T.LOUT_CAT_ID = #{loutCatId, jdbcType=VARCHAR}</if>
			<if test="mnuLoutKndCd != null and mnuLoutKndCd != ''">AND T.MNU_LOUT_KND_CD = #{mnuLoutKndCd, jdbcType=VARCHAR}</if>
			<if test="mnuGrpId != null and mnuGrpId != ''">AND T.MNU_GRP_ID = #{mnuGrpId, jdbcType=VARCHAR}</if>
			<if test="whereSqllet != null and whereSqllet != ''">${whereSqllet}</if>
		</where>
		<if test="orderBy != null">ORDER BY ${orderBy}</if>
		<if test="orderBy == null">ORDER BY T.COMP_ID, T.MNU_LOUT_ID</if>
		<if test="pageNo != null and pageRowCnt != null">
		LIMIT #{pageStrt, jdbcType=NUMERIC}, #{pageRowCnt, jdbcType=NUMERIC} ) M
		</if>
	</select>

	<select id="countPtMnuLoutD" resultType="Integer" parameterType="PtMnuLoutDVo" >
		/* com.innobiz.orange.web.pt.dao.PtMnuLoutDDao.countPtMnuLoutD */
		SELECT COUNT(*) CNT
		FROM PT_MNU_LOUT_D T
		<where>
			<if test="compId != null">AND T.COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test="mnuLoutId != null">AND T.MNU_LOUT_ID = #{mnuLoutId, jdbcType=VARCHAR}</if>
			<if test="loutCatId != null and loutCatId != ''">AND T.LOUT_CAT_ID = #{loutCatId, jdbcType=VARCHAR}</if>
			<if test="mnuLoutKndCd != null and mnuLoutKndCd != ''">AND T.MNU_LOUT_KND_CD = #{mnuLoutKndCd, jdbcType=VARCHAR}</if>
			<if test="mnuGrpId != null and mnuGrpId != ''">AND T.MNU_GRP_ID = #{mnuGrpId, jdbcType=VARCHAR}</if>
			<if test="whereSqllet != null and whereSqllet != ''">${whereSqllet}</if>
		</where>
	</select>

	<insert id="insertPtMnuLoutD" parameterType="PtMnuLoutDVo" >
		/* com.innobiz.orange.web.pt.dao.PtMnuLoutDDao.insertPtMnuLoutD */
		INSERT INTO PT_MNU_LOUT_D
		<trim prefix="(" suffix=")" suffixOverrides=",">
			COMP_ID,
			MNU_LOUT_ID,
			LOUT_CAT_ID,
			MNU_LOUT_PID,
			LOUT_LOC_CD,
			MNU_LOUT_KND_CD,
			MNU_GRP_ID,
			MNU_GRP_RESC_ID,
			IMG_KND_VA,
			MNU_LOUT_NM,
			RESC_ID,
			SORT_ORDR,
		</trim>
		<trim prefix="VALUES (" suffix=")" suffixOverrides="," >
			#{compId, jdbcType=VARCHAR},
			#{mnuLoutId, jdbcType=VARCHAR},
			#{loutCatId, jdbcType=VARCHAR},
			#{mnuLoutPid, jdbcType=VARCHAR},
			#{loutLocCd, jdbcType=VARCHAR},
			#{mnuLoutKndCd, jdbcType=VARCHAR},
			#{mnuGrpId, jdbcType=VARCHAR},
			#{mnuGrpRescId, jdbcType=VARCHAR},
			#{imgKndVa, jdbcType=VARCHAR},
			#{mnuLoutNm, jdbcType=NVARCHAR},
			#{rescId, jdbcType=VARCHAR},
			<if test="sortOrdr != null and sortOrdr != ''">#{sortOrdr, jdbcType=INTEGER},</if>
			<if test="sortOrdr == null or sortOrdr == ''">(SELECT IFNULL(MAX(P.SORT_ORDR),0)+1 FROM PT_MNU_LOUT_D P WHERE P.COMP_ID = #{compId, jdbcType=VARCHAR} AND P.LOUT_CAT_ID = #{loutCatId, jdbcType=VARCHAR} AND P.MNU_LOUT_PID = #{mnuLoutPid, jdbcType=VARCHAR}),</if>
		</trim>
	</insert>

	<update id="updatePtMnuLoutD" parameterType="PtMnuLoutDVo" >
		/* com.innobiz.orange.web.pt.dao.PtMnuLoutDDao.updatePtMnuLoutD */
		UPDATE PT_MNU_LOUT_D
		<set>
			<if test="compId != null">COMP_ID = #{compId, jdbcType=VARCHAR},</if>
			<if test="mnuLoutId != null">MNU_LOUT_ID = #{mnuLoutId, jdbcType=VARCHAR},</if>
			<if test="mnuLoutPid != null">MNU_LOUT_PID = #{mnuLoutPid, jdbcType=VARCHAR},</if>
			<if test="loutLocCd != null">LOUT_LOC_CD = #{loutLocCd, jdbcType=VARCHAR},</if>
			<if test="mnuLoutKndCd != null">MNU_LOUT_KND_CD = #{mnuLoutKndCd, jdbcType=VARCHAR},</if>
			<if test="mnuGrpId != null">MNU_GRP_ID = #{mnuGrpId, jdbcType=VARCHAR},</if>
			<if test="mnuGrpRescId != null">MNU_GRP_RESC_ID = #{mnuGrpRescId, jdbcType=VARCHAR},</if>
			<if test="imgKndVa != null">IMG_KND_VA = #{imgKndVa, jdbcType=VARCHAR},</if>
			<if test="mnuLoutNm != null">MNU_LOUT_NM = #{mnuLoutNm, jdbcType=NVARCHAR},</if>
			<if test="rescId != null">RESC_ID = #{rescId, jdbcType=VARCHAR},</if>
			<if test="sortOrdr != null">SORT_ORDR = #{sortOrdr, jdbcType=INTEGER},</if>
		</set>
		<where>
			<if test="compId != null">AND COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test="mnuLoutId != null">AND MNU_LOUT_ID = #{mnuLoutId, jdbcType=VARCHAR}</if>
			<if test="loutCatId != null and loutCatId != ''">AND LOUT_CAT_ID = #{loutCatId, jdbcType=VARCHAR}</if>
			<if test="whereSqllet != null and whereSqllet != ''">${whereSqllet}</if>
		</where>
	</update>

	<delete id="deletePtMnuLoutD" parameterType="PtMnuLoutDVo" >
		/* com.innobiz.orange.web.pt.dao.PtMnuLoutDDao.deletePtMnuLoutD */
		DELETE FROM PT_MNU_LOUT_D
		<where>
			<if test="compId != null">AND COMP_ID = #{compId, jdbcType=VARCHAR}</if>
			<if test="mnuLoutId != null">AND MNU_LOUT_ID = #{mnuLoutId, jdbcType=VARCHAR}</if>
			<if test="loutCatId != null and loutCatId != ''">AND LOUT_CAT_ID = #{loutCatId, jdbcType=VARCHAR}</if>
			<if test="loutLocCd != null and loutLocCd != ''">AND LOUT_LOC_CD = #{loutLocCd, jdbcType=VARCHAR}</if>
			<if test="whereSqllet != null and whereSqllet != ''">${whereSqllet}</if>
		</where>
	</delete>

</mapper>